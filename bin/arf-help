#!/bin/bash

maybe () {
    local name=$(basename $1)
    local main=${1}/main
    local doc=${1}/usage.short
    [ -f ${main} ] || return
    printf "    ${name}\t\t"
    [ -f ${doc} ] && cat ${doc} || echo

}

usage () {
    path=$1
    echo USAGE:
    echo "    ${BCH_HACK_NAME} $*" 
    echo SUBCOMMANDS:
    for ii in $(ls ${path}); do
        maybe ${path}/${ii}
    done
    [ -f ${path}/usage.long ] && cat ${path}/usage.long
}

main () {
    stem=
    path=${BCH_HACK_APPS}
    for ii in $*; do
        stem=${stem}/${ii}
        path=${path}/${ii}
        [ -e ${path}  ] || { echo bad command: [$stem]; return 87; }
    done
    usage ${path}
}

main $*
